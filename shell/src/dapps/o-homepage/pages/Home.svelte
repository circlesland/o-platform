<script lang="ts">
  import Navigation from "../components/Navigation.svelte";
  import VideoHeader from "../components/VideoHeader.svelte";
  import Mission from "../components/Mission.svelte";
  import Steps from "../components/Steps.svelte";
  import IntroAnimation from "../components/IntroAnimation.svelte";
  import { RunProcess } from "@o-platform/o-process/dist/events/runProcess";
  import {
    shellProcess,
    ShellProcessContext,
  } from "../../../shared/processes/shellProcess";
  import { Generate } from "@o-platform/o-utils/dist/generate";
  import {
    identify,
    IdentifyContextData,
  } from "../../o-passport/processes/identify/identify";
  import { me } from "../../../shared/stores/me";

  $: {
    console.log($me); // TODO: This is just to init the store. There could be a better solution to do this :)
  }

  $: me;

  async function login() {
    const requestEvent = new RunProcess<ShellProcessContext>(
      shellProcess,
      true,
      async (ctx) => {
        ctx.childProcessDefinition = identify;
        ctx.childContext = {
          data: <IdentifyContextData>{
            redirectTo: "/dashboard",
          },
        };
        return ctx;
      }
    );

    requestEvent.id = Generate.randomHexString(8);
    window.o.publishEvent(requestEvent);
  }
</script>

<!--
<div class="flex flex-col h-screen text-base bg-white bg-gradient-to-r">
  <main class="z-30 flex-1 overflow-y-visible">
    <Navigation />
    <div class="flex flex-col text-center justify-items-center pt-11">
      <h1 class="m-auto font-bold font-circles text-gradient w-42">
        You got us!
      </h1>
    </div>
  </main>
  <footer class="sticky bottom-0 z-50 w-full h-30 bg-secondary">
    <div class="container flex justify-around w-full">
      <div class="">left</div>
      <button on:click={login} class="px-8 m-2 btn btn-primary">
        Join us now
      </button>
      <div class="">right</div>
    </div>
  </footer>
</div> -->
<footer class="sticky bottom-0 z-50 w-full ">
  <div class="flex justify-around ">
    <button on:click={login} class="mb-24 btn btn-primary">
      <img
              width="15px"
              class="mr-3"
              src="/images/common/circles.png"
              alt="circles.land"
      /> Login
    </button>
  </div>
</footer>
<div class="flex flex-col h-screen">
  <Navigation />
  <main class="flex-1 overflow-y-auto">
    <VideoHeader />
    <IntroAnimation />
    <Steps />
    <Mission />
  </main>
  <footer>footer</footer>
</div>
